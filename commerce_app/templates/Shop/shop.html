{% extends 'Shop/base.html' %}
{% load static %}

{% block title %}
Shop - AShopper | Explore Our Collection
{% endblock %}

{% block main %}
<!-- Page Header Start -->
<div class="container-fluid mb-5" style="background: linear-gradient(135deg, #EDF1FF 0%, #f0f4ff 100%);">
  <div class="d-flex flex-column align-items-center justify-content-center" style="min-height: 250px">
    <h1 class="font-weight-bold text-uppercase mb-3" style="font-size: 3rem; color: #1C1C1C;">
      <i class="fas fa-shopping-bag mr-3 text-primary"></i>Shop Collection
    </h1>
    <div class="d-inline-flex align-items-center">
      <a href="{% url 'home' %}" class="text-dark font-weight-500">
        <i class="fas fa-home mr-2"></i>Home
      </a>
      <span class="mx-3 text-muted">|</span>
      <p class="m-0 text-primary font-weight-600">Shop</p>
    </div>
    <p class="text-muted mt-3">Discover amazing products at great prices</p>
  </div>
</div>
<!-- Page Header End -->

<!-- Shop Start -->
<div class="container-fluid pt-5">
  <div class="row px-xl-5">
    <!-- Shop Sidebar Start -->
    <div class="col-lg-3 col-md-12">
      <!-- Price Start -->
      <div class="border-bottom mb-4 pb-4">
        <h5 class="font-weight-semi-bold mb-4">Filter by price</h5>
        <form>
          <div class="custom-control custom-checkbox d-flex align-items-center justify-content-between mb-3">
            <input type="checkbox" class="custom-control-input" checked id="price-all" />
            <label class="custom-control-label" for="price-all">All Price</label>
            <span class="badge border font-weight-normal">1000</span>
          </div>
          <div class="custom-control custom-checkbox d-flex align-items-center justify-content-between mb-3">
            <input type="checkbox" class="custom-control-input" id="price-1" />
            <label class="custom-control-label" for="price-1">$0 - $100</label>
            <span class="badge border font-weight-normal">150</span>
          </div>
          <div class="custom-control custom-checkbox d-flex align-items-center justify-content-between mb-3">
            <input type="checkbox" class="custom-control-input" id="price-2" />
            <label class="custom-control-label" for="price-2">$100 - $200</label>
            <span class="badge border font-weight-normal">295</span>
          </div>
          <div class="custom-control custom-checkbox d-flex align-items-center justify-content-between mb-3">
            <input type="checkbox" class="custom-control-input" id="price-3" />
            <label class="custom-control-label" for="price-3">$200 - $300</label>
            <span class="badge border font-weight-normal">246</span>
          </div>
          <div class="custom-control custom-checkbox d-flex align-items-center justify-content-between mb-3">
            <input type="checkbox" class="custom-control-input" id="price-4" />
            <label class="custom-control-label" for="price-4">$300 - $400</label>
            <span class="badge border font-weight-normal">145</span>
          </div>
          <div class="custom-control custom-checkbox d-flex align-items-center justify-content-between">
            <input type="checkbox" class="custom-control-input" id="price-5" />
            <label class="custom-control-label" for="price-5">$400 - $500</label>
            <span class="badge border font-weight-normal">168</span>
          </div>
        </form>
      </div>
      <!-- Price End -->

      <!-- Color Start -->
      <div class="border-bottom mb-4 pb-4">
        <h5 class="font-weight-semi-bold mb-4">Filter by color</h5>
        <form>
          <div class="custom-control custom-checkbox d-flex align-items-center justify-content-between mb-3">
            <input type="checkbox" class="custom-control-input" checked id="color-all" />
            <label class="custom-control-label" for="price-all">All Color</label>
            <span class="badge border font-weight-normal">1000</span>
          </div>
          <div class="custom-control custom-checkbox d-flex align-items-center justify-content-between mb-3">
            <input type="checkbox" class="custom-control-input" id="color-1" />
            <label class="custom-control-label" for="color-1">Black</label>
            <span class="badge border font-weight-normal">150</span>
          </div>
          <div class="custom-control custom-checkbox d-flex align-items-center justify-content-between mb-3">
            <input type="checkbox" class="custom-control-input" id="color-2" />
            <label class="custom-control-label" for="color-2">White</label>
            <span class="badge border font-weight-normal">295</span>
          </div>
          <div class="custom-control custom-checkbox d-flex align-items-center justify-content-between mb-3">
            <input type="checkbox" class="custom-control-input" id="color-3" />
            <label class="custom-control-label" for="color-3">Red</label>
            <span class="badge border font-weight-normal">246</span>
          </div>
          <div class="custom-control custom-checkbox d-flex align-items-center justify-content-between mb-3">
            <input type="checkbox" class="custom-control-input" id="color-4" />
            <label class="custom-control-label" for="color-4">Blue</label>
            <span class="badge border font-weight-normal">145</span>
          </div>
          <div class="custom-control custom-checkbox d-flex align-items-center justify-content-between">
            <input type="checkbox" class="custom-control-input" id="color-5" />
            <label class="custom-control-label" for="color-5">Green</label>
            <span class="badge border font-weight-normal">168</span>
          </div>
        </form>
      </div>
      <!-- Color End -->

      <!-- Size Start -->
      <div class="mb-5">
        <h5 class="font-weight-semi-bold mb-4">Filter by size</h5>
        <form>
          <div class="custom-control custom-checkbox d-flex align-items-center justify-content-between mb-3">
            <input type="checkbox" class="custom-control-input" checked id="size-all" />
            <label class="custom-control-label" for="size-all">All Size</label>
            <span class="badge border font-weight-normal">1000</span>
          </div>
          <div class="custom-control custom-checkbox d-flex align-items-center justify-content-between mb-3">
            <input type="checkbox" class="custom-control-input" id="size-1" />
            <label class="custom-control-label" for="size-1">XS</label>
            <span class="badge border font-weight-normal">150</span>
          </div>
          <div class="custom-control custom-checkbox d-flex align-items-center justify-content-between mb-3">
            <input type="checkbox" class="custom-control-input" id="size-2" />
            <label class="custom-control-label" for="size-2">S</label>
            <span class="badge border font-weight-normal">295</span>
          </div>
          <div class="custom-control custom-checkbox d-flex align-items-center justify-content-between mb-3">
            <input type="checkbox" class="custom-control-input" id="size-3" />
            <label class="custom-control-label" for="size-3">M</label>
            <span class="badge border font-weight-normal">246</span>
          </div>
          <div class="custom-control custom-checkbox d-flex align-items-center justify-content-between mb-3">
            <input type="checkbox" class="custom-control-input" id="size-4" />
            <label class="custom-control-label" for="size-4">L</label>
            <span class="badge border font-weight-normal">145</span>
          </div>
          <div class="custom-control custom-checkbox d-flex align-items-center justify-content-between">
            <input type="checkbox" class="custom-control-input" id="size-5" />
            <label class="custom-control-label" for="size-5">XL</label>
            <span class="badge border font-weight-normal">168</span>
          </div>
        </form>
      </div>
      <!-- Size End -->
    </div>
    <!-- Shop Sidebar End -->

    <!-- Shop Product Start -->
    <div class="col-lg-9 col-md-12">
      <div class="row pb-3">
        <div class="col-12 pb-1">
          <div class="d-flex align-items-center justify-content-between mb-4">
            <form action="">
              <div class="input-group">
                <input type="text" class="form-control" placeholder="Search by name" />
                <div class="input-group-append">
                  <span class="input-group-text bg-transparent text-primary"><i class="fa fa-search"></i></span>
                </div>
              </div>
            </form>
            <div class="dropdown ml-4">
              <button class="btn border dropdown-toggle" type="button" id="triggerId" data-toggle="dropdown"
                aria-haspopup="true" aria-expanded="false">Sort by</button>
              <div class="dropdown-menu dropdown-menu-right" aria-labelledby="triggerId">
                <a class="dropdown-item" href="#">Latest</a>
                <a class="dropdown-item" href="#">Popularity</a>
                <a class="dropdown-item" href="#">Best Rating</a>
              </div>
            </div>
          </div>
        </div>

        {% for allproducts in items %}
        <div class="col-lg-4 col-md-6 col-sm-12 pb-1">
          <div class="card product-item border-0 mb-4 h-100">
            <div class="card-header product-img position-relative overflow-hidden bg-transparent border-0 p-0">
              <a href="{% url 'shop_detail' allproducts.id %}">
                <img class="img-fluid w-100" src="{{ allproducts.images.url }}" alt="{{ allproducts.title }}"
                     style="height: 280px; object-fit: cover; border-radius: 16px 16px 0 0;" />
              </a>
              {% if allproducts.category %}
                <span class="badge badge-primary position-absolute" style="top: 15px; left: 15px; z-index: 2; padding: 8px 15px; border-radius: 20px; font-weight: 600;">
                  <i class="fas fa-tag mr-1"></i>{{ allproducts.category }}
                </span>
              {% endif %}
              {% if allproducts.selling_price > allproducts.discount_price %}
                <span class="badge badge-danger position-absolute" style="top: 15px; right: 15px; z-index: 2; padding: 8px 15px; border-radius: 20px; font-weight: 600;">
                  <i class="fas fa-fire mr-1"></i>SALE
                </span>
              {% endif %}
              <div class="product-overlay position-absolute w-100 h-100 d-flex align-items-center justify-content-center" style="top: 0; left: 0; opacity: 0; transition: opacity 0.3s; border-radius: 16px 16px 0 0;">
                <a href="{% url 'shop_detail' allproducts.id %}" class="btn btn-primary btn-sm mx-1">
                  <i class="fas fa-eye"></i>
                </a>
                {% if request.user.is_authenticated and allproducts.id not in cart_product_ids %}
                  <a href="{% url 'all_cart_show' allproducts.id %}" class="btn btn-primary btn-sm mx-1">
                    <i class="fas fa-shopping-cart"></i>
                  </a>
                {% endif %}
              </div>
            </div>
            <div class="card-body text-center p-3 pt-4">
              <a href="{% url 'shop_detail' allproducts.id %}" class="text-decoration-none">
                <h6 class="text-truncate mb-3 font-weight-bold text-dark">{{ allproducts.title }}</h6>
              </a>
              {% if allproducts.brand %}
                <p class="text-muted small mb-2">
                  <i class="fas fa-copyright mr-1"></i>{{ allproducts.brand }}
                </p>
              {% endif %}
              <div class="d-flex justify-content-center align-items-center mb-2">
                <h5 class="text-primary mb-0 font-weight-bold">৳{{ allproducts.discount_price }}</h5>
                {% if allproducts.selling_price > allproducts.discount_price %}
                  <h6 class="text-muted ml-2 mb-0"><del>৳{{ allproducts.selling_price }}</del></h6>
                {% endif %}
              </div>
              <div class="mt-2">
                <i class="fas fa-star text-warning"></i>
                <i class="fas fa-star text-warning"></i>
                <i class="fas fa-star text-warning"></i>
                <i class="fas fa-star text-warning"></i>
                <i class="far fa-star text-warning"></i>
                <small class="text-muted ml-1">(4.0)</small>
              </div>
            </div>
            <div class="card-footer d-flex justify-content-center gap-2 bg-light border-0 py-3">
              <a href="{% url 'shop_detail' allproducts.id %}" class="btn btn-outline-primary btn-sm flex-fill">
                <i class="fas fa-eye mr-1"></i>View Details
              </a>

              {% if request.user.is_authenticated %}
                {% if allproducts.id in cart_product_ids %}
                  <a href="{% url 'cart_show' %}" class="btn btn-success btn-sm flex-fill">
                    <i class="fas fa-check mr-1"></i>In Cart
                  </a>
                {% else %}
                  <a href="{% url 'all_cart_show' allproducts.id %}" class="btn btn-primary btn-sm flex-fill">
                    <i class="fas fa-shopping-cart mr-1"></i>Add to Cart
                  </a>
                {% endif %}
              {% else %}
                <a href="{% url 'login' %}" class="btn btn-primary btn-sm flex-fill" onclick="event.preventDefault(); window.location='{% url 'login' %}?next={{ request.path }}'">
                  <i class="fas fa-shopping-cart mr-1"></i>Add to Cart
                </a>
              {% endif %}
            </div>
          </div>
        </div>
        {% endfor %}

        <div class="col-12 pb-1">
          <nav aria-label="Page navigation">
            <ul class="pagination justify-content-center mb-3">
              <!-- First and Previous -->
              {% if items.has_previous %}
                <li class="page-item">
                  <a class="page-link" href="?page=1" aria-label="First">
                    <span aria-hidden="true">&laquo;</span> First
                  </a>
                </li>
                <li class="page-item">
                  <a class="page-link" href="?page={{ items.previous_page_number }}" aria-label="Previous">
                    <span aria-hidden="true">&lsaquo;</span> Prev
                  </a>
                </li>
              {% else %}
                <li class="page-item disabled">
                  <span class="page-link"><span aria-hidden="true">&laquo;</span> First</span>
                </li>
                <li class="page-item disabled">
                  <span class="page-link"><span aria-hidden="true">&lsaquo;</span> Prev</span>
                </li>
              {% endif %}

              <!-- Page Numbers -->
              {% for i in items.paginator.page_range %}
                {% if items.number == i %}
                  <li class="page-item active">
                    <span class="page-link">{{ i }}</span>
                  </li>
                {% else %}
                  <li class="page-item">
                    <a class="page-link" href="?page={{ i }}">{{ i }}</a>
                  </li>
                {% endif %}
              {% endfor %}

              <!-- Next and Last -->
              {% if items.has_next %}
                <li class="page-item">
                  <a class="page-link" href="?page={{ items.next_page_number }}" aria-label="Next">
                    Next <span aria-hidden="true">&rsaquo;</span>
                  </a>
                </li>
                <li class="page-item">
                  <a class="page-link" href="?page={{ items.paginator.num_pages }}" aria-label="Last">
                    Last <span aria-hidden="true">&raquo;</span>
                  </a>
                </li>
              {% else %}
                <li class="page-item disabled">
                  <span class="page-link">Next <span aria-hidden="true">&rsaquo;</span></span>
                </li>
                <li class="page-item disabled">
                  <span class="page-link">Last <span aria-hidden="true">&raquo;</span></span>
                </li>
              {% endif %}
            </ul>
          </nav>
        </div> 
      </div>
    </div>
    <!-- Shop Product End -->
  </div>
</div>
<!-- Shop End -->

<style>
  .product-item:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 30px rgba(0,0,0,0.15) !important;
  }

  .product-img img {
    transition: transform 0.3s;
  }

  .product-item:hover .product-img img {
    transform: scale(1.05);
  }

  .btn-primary {
    background-color: #D19C97;
    border-color: #D19C97;
  }

  .btn-primary:hover {
    background-color: #c08880;
    border-color: #c08880;
  }

  .btn-outline-primary {
    color: #D19C97;
    border-color: #D19C97;
  }

  .btn-outline-primary:hover {
    background-color: #D19C97;
    border-color: #D19C97;
    color: white;
  }

  .text-primary {
    color: #D19C97 !important;
  }

  .badge-primary {
    background-color: #D19C97;
  }

  .product-item .card-body h6 {
    min-height: 45px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  @media (max-width: 768px) {
    .product-img img {
      height: 200px !important;
    }
  }
</style>

{% endblock main %}